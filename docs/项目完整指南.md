

# é¡¹ç›®å®Œæ•´æŒ‡å—

------

## ğŸ“‹ é¡¹ç›®æ€»è§ˆ

**ç›®æ ‡**: é€šè¿‡å®éªŒéªŒè¯Combineråœ¨ä¸åŒæ•°æ®åˆ†å¸ƒä¸‹å¯¹MapReduceæ€§èƒ½çš„å½±å“

####  **ç ”ç©¶å†…å®¹**

1. åˆ†æCombineråœ¨MapReduceæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä½œç”¨ä¸æ•ˆæœã€‚
2. å…·ä½“åŒ…æ‹¬ï¼šCombineræ˜¯å¦èƒ½ å¤Ÿæœ‰æ•ˆå‡å°‘Shuffleé˜¶æ®µçš„æ•°æ®é‡ï¼Ÿ
3. åœ¨ä¸åŒçš„keyåˆ†å¸ƒï¼ˆå‡åŒ€åˆ†å¸ƒä¸æ•°æ®å€¾æ–œï¼‰ä¸‹ï¼Œå…¶æ€§èƒ½æå‡æ•ˆæœæœ‰ä½•å·®å¼‚ï¼Ÿ
4. æ˜¯å¦æ‰€æœ‰åœºæ™¯éƒ½é€‚åˆä½¿ç”¨Combinerï¼Ÿ

------

# ğŸ—“ï¸ Part 1: é›†ç¾¤ç¯å¢ƒæ­å»º 

### Step 1:å®‰è£…WSL

**WSLåŠŸèƒ½çš„å¼€å¯**

1. æŒ‰ `Win`ï¼Œæœç´¢â€œå¯ç”¨æˆ–å…³é—­ Windows åŠŸèƒ½â€å¹¶æ‰“å¼€ã€‚

2. å¼€å¯ç›¸å…³åŠŸèƒ½-â€œé€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿâ€ å’Œ  â€œè™šæ‹Ÿæœºå¹³å°ï¼ˆVirtual Machine Platformï¼‰

   ![image-20251117210411627](docs\images\image-20251117212255838.png)

**å®‰è£…WSL**

```bash
 wsl --install   #å®‰è£…wslï¼Œå› ä¸ºæœ€æ–°windowsæ›´æ–°åçš„å…¼å®¹é—®é¢˜å¯¼è‡´å¿…é¡»å®‰è£…wslï¼Œä¼šè‡ªåŠ¨å®‰è£…ubuntu
 wsl --set-default-version 2  # wsl --set-default-version 2

#æµ‹è¯•wslæ˜¯å¦æœ‰å®‰è£…ä¸Šï¼Œå¦åˆ™åç»­æ‰“å¼€dockerä¼šæŠ¥é”™
wsl -v 

```

### Step 2: å®‰è£…Docker Desktop

**Windowsç”¨æˆ·ï¼š**

```bash
# 1. ä¸‹è½½Docker Desktop
# è®¿é—®: https://www.docker.com/products/docker-desktop/

# 2. å®‰è£…å¹¶é‡å¯ç”µè„‘

# 3. éªŒè¯å®‰è£…
docker --version   #Docker version 28.5.2, build ecc6942
docker-compose --version
```

### Step 3: åˆ›å»ºé¡¹ç›®ç»“æ„

```bash
# é€šè¿‡powershellæ‰“å¼€ï¼Œåˆ›å»ºé¡¹ç›®æ ¹ç›®å½•
mkdir mapreduce-combiner-analysis
cd mapreduce-combiner-analysis

# åˆ›å»ºå­ç›®å½•
mkdir -p code/mapreduce/with-combiner  #å¸¦æœ‰combinerçš„å®éªŒè®¾è®¡å’Œç¼–ç 
mkdir -p code/mapreduce/without-combiner  #ä¸å¸¦æœ‰combinerçš„å®éªŒè®¾è®¡å’Œç¼–ç 
mkdir -p code/data-generator  #ç”Ÿæˆå®éªŒæ‰€éœ€çš„æ•°æ®é›†
mkdir -p code/cluster-config  #æ­å»ºé›†ç¾¤é…ç½®
mkdir -p code/results  #å¯¹å®éªŒç»“æœè¿›è¡Œåˆ†æ
mkdir -p code/scripts  #æ·»åŠ è„šæœ¬
mkdir -p docs/images  #å†™markdownç”¨åˆ°çš„å›¾ç‰‡é“¾æ¥
```

### Step 4: é…ç½®åˆ†å¸ƒå¼Hadoopé›†ç¾¤ - ä¸»èŠ‚ç‚¹

#### 4.1 å‰ç½®å‡†å¤‡

**ç¡®è®¤ç½‘ç»œç¯å¢ƒ**

- âœ… ç¡®ä¿æ‰€æœ‰ç»„å‘˜åœ¨**åŒä¸€å±€åŸŸç½‘**ï¼ˆåŒä¸€WiFi/æ ¡å›­ç½‘ï¼‰
- âœ… å¦‚æœä¸åœ¨åŒä¸€ç½‘ç»œï¼Œå¯ä½¿ç”¨ **ZeroTier** æˆ– **Tailscale** ç»„ç½‘å·¥å…·

**è·å–ä½ çš„IPåœ°å€**

```bash
# Windows PowerShell æ‰§è¡Œ
ipconfig

# æ‰¾åˆ° "æ— çº¿å±€åŸŸç½‘é€‚é…å™¨ WLAN" æˆ– "ä»¥å¤ªç½‘é€‚é…å™¨"
# è®°å½• IPv4 åœ°å€ï¼Œä¾‹å¦‚: 192.168.1.100

#æµ‹è¯•æ˜¯å¦èƒ½å¤Ÿè¿æ¥
ping ipv4  
```

**Windowsè®¾ç½®å¼€æ”¾é˜²ç«å¢™**ï¼š

1. æŒ‰ `Win + R`ï¼Œè¾“å…¥ `wf.msc`ï¼Œæ‰“å¼€"é«˜çº§å®‰å…¨Windows Defenderé˜²ç«å¢™"

2. ç‚¹å‡»å·¦ä¾§ **"å…¥ç«™è§„åˆ™"** â†’ å³ä¾§ **"æ–°å»ºè§„åˆ™"**

3. é€‰æ‹© **"ç«¯å£"** â†’ ä¸‹ä¸€æ­¥

4. é€‰æ‹© **"TCP"**ï¼Œè¾“å…¥ç«¯å£å·ï¼ˆå¦‚ `9870,8020,9000,8088,8030-8032,8188`ï¼‰

5. é€‰æ‹© **"å…è®¸è¿æ¥"** â†’ ä¸‹ä¸€æ­¥

6. å…¨é€‰ï¼ˆåŸŸã€ä¸“ç”¨ã€å…¬ç”¨ï¼‰â†’ ä¸‹ä¸€æ­¥

7. è¾“å…¥è§„åˆ™åç§°ï¼ˆå¦‚ `Hadoop Master Ports`ï¼‰â†’ å®Œæˆ

8. ```bash
   - 9870: è¿™æ˜¯ HDFS æ–‡ä»¶ç³»ç»Ÿçš„ç®¡ç†ç•Œé¢ï¼ŒUI
   - 8020: HDFS RPCé€šä¿¡ï¼Œè¿›è¡Œæ•°æ®çš„äº¤äº’
   - 9000: HDFS NameNodeå¤‡ç”¨ç«¯å£
   - 8088: ResourceManager Web UIï¼ŒæŸ¥çœ‹æ•´ä¸ª YARN é›†ç¾¤çŠ¶æ€ï¼š
   - 8030: ResourceManager Schedulerï¼Œç®¡ç†å„é˜Ÿåˆ—çš„èµ„æºé…é¢
   - 8031: ResourceManager Resource Trackerï¼ŒèŠ‚ç‚¹èµ„æºæƒ…å†µï¼ˆCPU/å†…å­˜ï¼‰
   - 8032: ResourceManager RPC
   - 8188: HistoryServer Web UIï¼ŒæŸ¥çœ‹å†å²ä¿¡æ¯ï¼ˆè¿è¡Œæ—¶é—´ã€è¾“å…¥ã€è¾“å‡ºã€Shuffle é‡ï¼‰
   ```

#### 4.2 åˆ›å»ºä¸»èŠ‚ç‚¹é…ç½®æ–‡ä»¶

**Docker Composeé…ç½®**:`code/docker-compose-master.yml`

```bash
#å‘½ä»¤è¡Œæ–°å»ºä¸€ä¸ª,æ§åˆ¶å°è¿è¡Œæ–°å»ºä¸€ä¸ªç©ºæ–‡ä»¶
New-Item code/docker-compose-master.yml -ItemType File
```

**Hadoopç¯å¢ƒé…ç½®**:`code/cluster-config/hadoop-master.env`

```bash
New-Item code/cluster-config/hadoop-master.env -ItemType File
```

**é›†ç¾¤ç®¡ç†è„šæœ¬**: `code/scripts/cluster-manager.sh`

```bash
New-Item code/scripts/cluster-manager.sh -ItemType File
```

#### 4.3 å¯åŠ¨ä¸»èŠ‚ç‚¹

**é…ç½®å®¹å™¨ç¯å¢ƒ** 

```powershell
# åœ¨ PowerShell ä¸­æ‰§è¡Œ

#ä¸‹è½½é…ç½®ï¼šæ³¨ï¼šï¼ˆéœ€è¦æŒ‚æ¢¯å­æˆ–è€…å¯ç”¨é•œåƒåŠ é€Ÿï¼šdocker desktop -> setting -> docker engineé…ç½®é•œåƒï¼‰
docker-compose -f code/docker-compose-master.yml up -d

# 3. ç­‰å¾…å®¹å™¨å¯åŠ¨ï¼ˆçº¦ 10-30 ç§’ï¼‰
Start-Sleep -Seconds 15

# 4. æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker ps

# 5. è¿›å…¥ namenode å®¹å™¨
docker exec -it namenode bash
```

**åœ¨å®¹å™¨å†…æ‰§è¡Œï¼š**

```bash
# 6. èµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™,æŒ‚è½½åœ¨
chmod +x /opt/scripts/cluster-manager.sh

# 7. éªŒè¯æƒé™
ls -l /scripts/cluster-manager.sh
# åº”è¯¥æ˜¾ç¤ºï¼š-rwxr-xr-x

# 8. æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ä»¥æ‰§è¡Œ
/scripts/cluster-manager.sh --help

# 9. é€€å‡ºå®¹å™¨
exit
```

**å›åˆ° PowerShellï¼š**

powershell

```powershell
# 10. ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨è„šæœ¬äº†
docker exec namenode /scripts/cluster-manager.sh start
```

## ğŸ“š å‚è€ƒèµ„æ–™

1. Hadoopå®˜æ–¹æ–‡æ¡£: https://hadoop.apache.org/docs/r3.2.1/
2. MapReduceè®ºæ–‡: Dean, Jeffrey, and Sanjay Ghemawat. "MapReduce: simplified data processing on large clusters."
3. Dockeræ–‡æ¡£: https://docs.docker.com/

